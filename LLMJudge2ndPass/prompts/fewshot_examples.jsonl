{"id":"ex_sql_injection","label":"insecure","cwe_tags":["CWE-89"],"mini_snippet":"query = f\"SELECT * FROM users WHERE name = '{name}'\"\ncursor.execute(query)","explanation":"Builds raw SQL with untrusted input and executes it. This is direct SQL injection.","code":"def get_user(db, name):\n    cursor = db.cursor()\n    query = f\"SELECT * FROM users WHERE name = '{name}'\"\n    cursor.execute(query)\n    return cursor.fetchall()\n"}
{"id":"ex_cmd_injection","label":"insecure","cwe_tags":["CWE-78"],"mini_snippet":"cmd = \"tar -czf backup.tgz \" + target\nsubprocess.run(cmd, shell=True)","explanation":"Untrusted input concatenated into a shell command with shell=True. Command injection risk.","code":"import subprocess\n\ndef backup(target):\n    cmd = \"tar -czf backup.tgz \" + target\n    subprocess.run(cmd, shell=True)\n"}
{"id":"ex_path_traversal","label":"insecure","cwe_tags":["CWE-22"],"mini_snippet":"with open(base_dir + \"/\" + filename, \"wb\") as f:\n    f.write(data)","explanation":"User-controlled filename concatenated to a path without normalization allows ../ traversal.","code":"def save_file(base_dir, filename, data):\n    with open(base_dir + \"/\" + filename, \"wb\") as f:\n        f.write(data)\n"}
{"id":"ex_xss_reflected","label":"insecure","cwe_tags":["CWE-79"],"mini_snippet":"return \"<h1>\" + title + \"</h1>\"","explanation":"Unescaped user-controlled HTML is reflected to the browser, enabling XSS.","code":"from flask import Flask, request\napp = Flask(__name__)\n@app.route('/show')\ndef show():\n    title = request.args.get('title','')\n    return \"<h1>\" + title + \"</h1>\"\n"}
{"id":"ex_deserialization","label":"insecure","cwe_tags":["CWE-502"],"mini_snippet":"obj = pickle.loads(blob)","explanation":"Unsafe deserialization of untrusted data using pickle.","code":"import pickle\n\ndef load_blob(blob):\n    obj = pickle.loads(blob)\n    return obj\n"}
{"id":"ex_permissions","label":"insecure","cwe_tags":["CWE-732"],"mini_snippet":"os.chmod(path, 0o777)","explanation":"File is granted world-writable permissions, which is overly permissive.","code":"import os\n\ndef write_and_open(path, data):\n    with open(path,'wb') as f:\n        f.write(data)\n    os.chmod(path, 0o777)\n"}
{"id":"ex_hardcoded_secret","label":"insecure","cwe_tags":["CWE-798"],"mini_snippet":"API_KEY = \"abcd1234\"","explanation":"Hardcoded credential in code.","code":"API_KEY = \"abcd1234\"\n\ndef call():\n    return API_KEY\n"}
{"id":"ex_input_validation_only","label":"secure","cwe_tags":[],"mini_snippet":"","explanation":"Input is validated but no dangerous sink is present.","code":"def f(x):\n    if not isinstance(x,int):\n        raise ValueError(\"x must be int\")\n    return x*2\n"}
{"id":"ex_http_but_no_sink","label":"secure","cwe_tags":[],"mini_snippet":"","explanation":"HTTP request building without any command/SQL/fs/deserialization sink is not a CWE here.","code":"import requests\n\ndef fetch(url):\n    resp = requests.get(url)\n    return resp.text\n"}
{"id":"ex_template_safe","label":"secure","cwe_tags":[],"mini_snippet":"","explanation":"Template rendering uses a static template; no unescaped user HTML is inserted.","code":"from flask import render_template\n\ndef page():\n    return render_template('home.html')\n"}